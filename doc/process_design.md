# injesta


***

### Process Design

The following figure shows the how each system process is constructed from a number of Erlang processes:

**Erlang Process Design**
![Erlang Process Design](https://github.com/PeteFurniss/injesta/blob/master/doc/core_process.png  "Erlang Process Design")

####Core Data Handler

Each system process centres on a Core Data Handler process. Based on an OTP gen_server process, the Core Data Handler receives data messages, one at a time from the Input Queue, via the Queue Reader process.

Having received a message, the Core Data Handler calls the process_message function of the Application-Specific Callback Module. The process_message function performs application=-specific processing on the message it is given and returns the result to the Core Data Handler.

The Core Data Handler then forwards the result to the Output Queue via the Queue Writer process.

The Core Data Handler is configured with configuration data it reads from the Configuration Data Module. Using the Core Data Handler process name as key, the Configuration Data Module returns details of the modules with which the Core Data Handler interfaces. It is the configuration data together with the Application-Specific Callback Module that turn a generic Core Data Handler process into a process that performs a specific task in the processing pipeline.

####Queue Reader/Writer

The Queue Reader/Writer processes provide the queue-technology-specific interfaces to the Input/Output Queues. The Queue Reader reads messages one by one from the Input Queue and forwards them to the Core Data Handler process. The Queue Writer takes the messages generated by the Core Data Handler and writes them to the Output Queue.

####Supervisor

The Supervisor is responsible for starting and stopping the Core Data Handler and for restarting it in the event of process failure.

####Message/Metrics Logger

Message and metrics logging is performed by two system-wide processes, the Message Logger and the Metrics Logger.